<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Draw & Animate!</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive;
      text-align: center;
      background: #fff8dc;
      margin: 0;
      padding: 20px;
    }
    canvas {
      border: 3px dashed #ffa500;
      border-radius: 12px;
      background: transparent;
    }
    button {
      margin: 10px;
      background-color: #ffcd4b;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 25px;
      cursor: pointer;
      box-shadow: 2px 2px 5px #999;
    }
    #animatedContainer img {
      position: absolute;
      width: 100px;
      animation: float 3s infinite ease-in-out;
    }
    @keyframes float {
      0%   { transform: translate(0, 0); }
      25%  { transform: translate(30px, -20px); }
      50%  { transform: translate(0, -40px); }
      75%  { transform: translate(-30px, -20px); }
      100% { transform: translate(0, 0); }
    }
    #savedCharacters img {
      width: 80px;
      margin: 10px;
    }
  </style>
</head>
<body>

  <h1>ðŸŽ¨ Draw & Animate!</h1>
  <video id="video" autoplay playsinline style="display:none;"></video>
  <canvas id="drawingCanvas" width="400" height="300"></canvas>
  <br>
  <button id="clearBtn">ðŸ§¼ Clear</button>
  <button id="captureBtn">ðŸ“¸ Bring to Life</button>
  <input type="text" id="nameInput" placeholder="Name your character..." />

  <div id="animatedContainer"></div>

  <h2>ðŸ§º Saved Characters</h2>
  <div id="savedCharacters"></div>

  <script>
    const canvas = document.getElementById('drawingCanvas');
    const ctx = canvas.getContext('2d', { willReadFrequently: true });
    const captureBtn = document.getElementById('captureBtn');
    const clearBtn = document.getElementById('clearBtn');
    const nameInput = document.getElementById('nameInput');
    const animatedContainer = document.getElementById('animatedContainer');
    const savedCharacters = document.getElementById('savedCharacters');

    let drawing = false;

    // Transparent background
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    canvas.addEventListener('mousedown', (e) => {
      drawing = true;
      ctx.beginPath();
      ctx.moveTo(e.offsetX, e.offsetY);
    });

    canvas.addEventListener('mousemove', (e) => {
      if (drawing) {
        ctx.lineTo(e.offsetX, e.offsetY);
        ctx.strokeStyle = 'black';
        ctx.lineWidth = 3;
        ctx.lineCap = 'round';
        ctx.stroke();
      }
    });

    canvas.addEventListener('mouseup', () => drawing = false);
    canvas.addEventListener('mouseleave', () => drawing = false);

    clearBtn.onclick = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    };

    captureBtn.onclick = () => {
      const name = nameInput.value.trim() || "My Character";

      // Convert canvas to image with transparency
      const imageURL = canvas.toDataURL('image/png');
      const img = document.createElement('img');
      img.src = imageURL;
      img.alt = name;
      img.style.left = Math.random() * (window.innerWidth - 100) + 'px';
      img.style.top = Math.random() * (window.innerHeight - 300) + 'px';
      animatedContainer.appendChild(img);

      // Voice feedback
      const utter = new SpeechSynthesisUtterance(`You just brought ${name} to life! That's amazing!`);
      speechSynthesis.speak(utter);

      // Save to gallery
      const thumb = document.createElement('img');
      thumb.src = imageURL;
      thumb.title = name;
      savedCharacters.appendChild(thumb);

      // Reset
      nameInput.value = '';
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    };

    // Optionally use camera as background/sketch guide (invisible unless debug)
    async function setupCamera() {
      const video = document.getElementById('video');
      try {
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: { exact: "environment" } }
        });
        video.srcObject = stream;
      } catch (err) {
        console.warn("Back camera not found. Using default.");
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        video.srcObject = stream;
      }
    }

    setupCamera();
  </script>
</body>
</html>
