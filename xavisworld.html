<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Draw & Bring It to Life!</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive;
      text-align: center;
      background: #fdf6e3;
      overflow: hidden;
      margin: 0;
      padding: 20px;
    }
    #video, #canvas {
      display: none;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 18px;
      background: #ffcc70;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    .character {
      position: absolute;
      width: 100px;
      transition: transform 0.3s ease;
      animation: rotateAndBounce 5s infinite linear;
    }
    @keyframes rotateAndBounce {
      0% { transform: rotate(0deg) translateY(0); }
      25% { transform: rotate(15deg) translateY(-20px); }
      50% { transform: rotate(0deg) translateY(0); }
      75% { transform: rotate(-15deg) translateY(20px); }
      100% { transform: rotate(0deg) translateY(0); }
    }
    #drawArea {
      border: 2px dashed #aaa;
      background: white;
      touch-action: none;
    }
    input, label {
      font-size: 16px;
      margin: 10px;
    }
  </style>
</head>
<body>

  <h1>üé® Draw & Watch It Come to Life! üêæ</h1>

  <canvas id="drawArea" width="300" height="300"></canvas><br>
  <label for="charName">Character Name: </label>
  <input type="text" id="charName" placeholder="e.g. Bouncy Lion" /><br>
  <button id="spawnBtn">‚ú® Bring to Life!</button>

  <canvas id="canvas" width="300" height="300"></canvas>
  <video id="video" autoplay playsinline></video>

  <div id="charactersContainer"></div>

  <script>
    const drawCanvas = document.getElementById('drawArea');
    const drawCtx = drawCanvas.getContext('2d');
    const spawnBtn = document.getElementById('spawnBtn');
    const charactersContainer = document.getElementById('charactersContainer');

    let isDrawing = false;

    // Drawing logic
    drawCanvas.addEventListener('pointerdown', (e) => {
      isDrawing = true;
      drawCtx.beginPath();
      drawCtx.moveTo(e.offsetX, e.offsetY);
    });

    drawCanvas.addEventListener('pointermove', (e) => {
      if (!isDrawing) return;
      drawCtx.lineTo(e.offsetX, e.offsetY);
      drawCtx.strokeStyle = '#000';
      drawCtx.lineWidth = 4;
      drawCtx.lineCap = 'round';
      drawCtx.stroke();
    });

    drawCanvas.addEventListener('pointerup', () => {
      isDrawing = false;
    });

    // Voice feedback
    function speakFact(name) {
      const facts = [
        `Did you know ${name} loves to bounce on clouds?`,
        `${name} is a legendary explorer of candy lands!`,
        `Fun fact: ${name} can spin and dance all day long!`
      ];
      const fact = facts[Math.floor(Math.random() * facts.length)];
      const utterance = new SpeechSynthesisUtterance(`You just created ${name}! ${fact}`);
      speechSynthesis.speak(utterance);
    }

    // Bring drawing to life
    spawnBtn.onclick = () => {
      const name = document.getElementById('charName').value.trim() || 'My Character';
      const img = new Image();
      img.src = drawCanvas.toDataURL('image/png');
      img.className = 'character';
      img.alt = name;

      // Random start position
      img.style.top = Math.random() * (window.innerHeight - 120) + 'px';
      img.style.left = Math.random() * (window.innerWidth - 120) + 'px';

      charactersContainer.appendChild(img);

      // Animate movement
      animateCharacter(img);

      // Voice feedback
      speakFact(name);
    };

    // Movement logic
    function animateCharacter(el) {
      let x = parseFloat(el.style.left) || 100;
      let y = parseFloat(el.style.top) || 100;
      let dx = (Math.random() - 0.5) * 3;
      let dy = (Math.random() - 0.5) * 3;

      function move() {
        x += dx;
        y += dy;

        // Bounce off edges
        if (x < 0 || x > window.innerWidth - 100) dx *= -1;
        if (y < 0 || y > window.innerHeight - 100) dy *= -1;

        el.style.left = x + 'px';
        el.style.top = y + 'px';

        requestAnimationFrame(move);
      }

      move();
    }

    // Optional: Use back camera (if needed in future)
    async function setupCamera() {
      const constraints = {
        video: {
          facingMode: { exact: "environment" } // Try back camera
        }
      };

      try {
        const stream = await navigator.mediaDevices.getUserMedia(constraints);
        const video = document.getElementById('video');
        video.srcObject = stream;
      } catch (err) {
        console.warn("Back camera not available. Falling back to default.");
      }
    }

    setupCamera();
  </script>
</body>
</html>
